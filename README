#########################################################################################################

A repository for conducting association testing in REGENIE
for participating cohorts in the elevated symptoms of depression in adolescence GWAS

We provide example scripts for running REGENIE in the ALSPAC cohort

- Install REGENIE if not already installed: https://rgcgithub.github.io/regenie/install/
- To use example scripts as templates: Clone this GitHub repository (git clone git@github.com:poppyzenzi/AD_GWAS_pipeline.git) and edit as appropriate
- If you already have a pipeline set-up or don't need templates, please still refer to our examples to make sure flags and thresholds correspond 
- Return back to the SOP for how to upload and report your results

For any questions or uncertainties please contact Poppy Grimes at p.grimes@ed.ac.uk


STEP 1 flags:
# --bed = PLINK binary files prefix for .bed/.bim/.fam files
# --extract = List of SNPs that pass QC filter (We generate this list in PLINK, however if you have already performed sufficient QC on your genotyped data file, you can omit this flag)
# --phenoFile = path to your phenotype file with the header FID IID pheno_col
# --phenoCol = phenotype column name
# --bsize = chunk size for analysis
# --bt = binary trait
# --out = path to output file

STEP 2 flags:
# --bgen = path to imputed data. Here we use the .bgen format split by chromosome. See REGENIE documention for more info on file input
# --phenoFile = path to your phenotype file with the header FID IID pheno_col
# --phenoCol = phenotype column name
# --sample = sample file corresponding to input bgen (can also use --keep / --remove flags to only include indiviudals that pass QC filtering, see REGENIE documentation)
# --bsize = chunk size for analysis
# --minMAC = minimum minor allele count
# --minINFO = minimum imputation info score
# --bt = binary trait
# --firth --approx = firth LRT, computational speed up
# --pThresh = P-value threshold to apply firth correction
# --pred = path to file containing predictions from STEP 1
# --out = path to output file(s)
#########################################################################################################
