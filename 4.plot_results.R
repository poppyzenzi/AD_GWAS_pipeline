library(topr)
library(dplyr)

## Requirements
# Please make sure -log10P values have been converted to raw P values before running this script
# See shell script `convert_-log10P.sh`

# Set working directory
setwd('/exports/igmm/eddie/GenScotDepression/users/poppy/aGWAS/cohorts/alspac/output')

# Read the list of ancestries (in ALSPAC we only have EUR)
ancestry_list <- c("EUR")

## Plot Manhattan
for (ancestry in ancestry_list) {

  sumstats <- read.table(paste0("alspac_P_adoldep_", ancestry, ".regenie"), header = TRUE)
 
 # NOTE: Cols may need renaming if not generated by regenie (require: CHROM, POS, P)
 
 # Set working directory for plots
  setwd('/exports/igmm/eddie/GenScotDepression/users/poppy/aGWAS/plots')

  tiff(paste0("alspac_manhattan_plot_", ancestry, ".tiff"), width = 10, height = 6, units = "in", res = 300)

  manhattan(df = filtered,
            legend_labels = "",
            sign_thresh = 5e-08,
            sign_thresh_color = "black",
            sign_thresh_label_size = 0,
	    ymax = 20, ymin = 3, scale = 0.8,
            title = paste("ALSPAC (", ancestry, ")"))

  dev.off()
}

## Plot QQ

for (ancestry in ancestry_list) {

  sumstats <- read.table(paste0("alspac_P_adoldep_", ancestry, ".regenie"), header = TRUE)

  setwd('/exports/igmm/eddie/GenScotDepression/users/poppy/aGWAS/plots')
  
  tiff(paste0("alspac_qq_plot_", ancestry, ".tiff"), width=6, height=6, units="in", res=300)

  qqtopr(sumstats, title=paste("ALSPAC (", ancestry, ")"))

  dev.off()

}

###############################################################################
