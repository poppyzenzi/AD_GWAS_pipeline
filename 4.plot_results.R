library(topr)
library(dplyr)

## Please make sure you have filtered SNPs (P<=1e-03) and converted P values before running this script
# See shell scripts `convert_-log10P.sh` and `filter_SNPs_to_plot.sh`


# Set working directory
setwd('/exports/igmm/eddie/GenScotDepression/users/poppy/aGWAS/cohorts/alspac/output')

# Read the list of ancestries (in ALSPAC we only have EUR)
ancestry_list <- c("EUR")


# Loop through each ancestry
for (ancestry in ancestry_list) {

 # Read data for the current ancestry
  sumstats <- read.table(paste0("alspac_P_adoldep_", ancestry, ".regenie"), header = TRUE)
 
 # NOTE: Cols may need renaming if not generated by regenie (require: CHROM, POS, P)
 
 # Set working directory for plots
  setwd('/exports/igmm/eddie/GenScotDepression/users/poppy/aGWAS/plots')

 # Open tiff device
  tiff(paste0("alspac_manhattan_plot_", ancestry, ".tiff"), width = 10, height = 6, units = "in", res = 300)

  # Plot
  manhattan(df = filtered,
            legend_labels = "",
            sign_thresh = 5e-08,
            sign_thresh_color = "black",
            sign_thresh_label_size = 0,
           #annotate= 5e-08,
	    ymax = 20, ymin = 3, scale = 0.8,
            color = "darkred",
            title = paste("ALSPAC (", ancestry, ")"))

  # Close tiff
  dev.off()
}


